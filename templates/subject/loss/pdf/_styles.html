{% if pdf_mode %}
<style>
  /* ===== PDF-only: hide app chrome, page setup, print adjustments ===== */
  a.skip-link, .skip-link, #skip, #skipnav, #skip-to-content, #skip_content, #skip-content,
  a[href="#content"], a[href="#main"], a[href="#main-content"], a[href^="#skip"],
  [aria-label="Skip to content"], [aria-label="Skip To Content"],
  .sr-only.skip-link { display:none !important; }

  header, nav, footer, #header, #navbar, #topbar,
  .site-header, .navbar, .topbar, .site-footer, #footer { display:none !important; }
  header input, header button, header form, body>input, body>button, body>form { display:none !important; }

  * { -webkit-print-color-adjust: exact; print-color-adjust: exact; }

  @page {
    margin: 25mm 16mm 18mm 16mm;
    @top-center    { content: element(pdf-running-header); }
    @bottom-center { content: "Page " counter(page) " of " counter(pages); font-size: 10pt; color: #475569; }
  }

  /* .pdf-break-before { break-before: page; page-break-before: always; } */

  html, body { background:#fff; color:#111827; font-size:12pt; }
  .shadow, .shadow-md, .shadow-lg { box-shadow:none !important; }
  .rounded-2xl, .rounded-xl { border-radius:0 !important; }

  .phase-card { break-inside: avoid; page-break-inside: avoid; line-height: normal; }
  .phase-card + .phase-card { break-before: page; }

  .pdf-running-header { position: running(pdf-running-header); }
  .pdf-small { font-size: 10pt; color: #475569; }

  .report-title   { text-align:center; font-size:22pt; font-weight:700; margin:8mm 0 4mm; }
  .report-runline { text-align:center; color:#64748b; font-size:10.5pt; margin-bottom:6mm; }

  .pdf-progress-block { margin-top:10px; padding-left:0; list-style:none; }
  .pdf-progress-block * { list-style:none; }

  .pdf-progress-line { font-size:13px; line-height:1.6; margin:6px 0 8px; }
  .pdf-progress-line .chip { margin-left:6px; }

  .pdf-progress-list { margin:0 0 0 18px; padding:0; list-style:disc; }
  .pdf-progress-list li { line-height:1.7; margin:6px 0; }

  .pdf-comment-list { font-size:13px; line-height:1.6; margin-top:4px; }
  .pdf-comment-list li { margin-bottom:6px; }
</style>
{% endif %}

<style>
  /* ===== Shared (screen + PDF): bars, widths, chips ===== */

  /* Horizontal bar & scale */
  .phase-graph { margin-top:8px; }
  .phase-graph .bar {
    position:relative; width:100%; height:12px;
    border-radius:9999px; background:#e5e7eb; overflow:hidden;
  }
  .phase-graph .bar .fill { height:100%; border-radius:9999px; }
  .bar-scale { display:flex; justify-content:space-between; margin-top:4px; font-size:11px; color:#64748b; }

  /* Bar colors used by _bar_graph.html */
  .bar-emerald { background:#10b981; }
  .bar-amber   { background:#f59e0b; }
  .bar-rose    { background:#ef4444; }
  .bar-blue    { background:#3b82f6; }
  .bar-mint    { background:#86efac; }

  /* Width utilities (0..100 step 5) */
  .w-0{width:0%}.w-5{width:5%}.w-10{width:10%}.w-15{width:15%}.w-20{width:20%}.w-25{width:25%}
  .w-30{width:30%}.w-35{width:35%}.w-40{width:40%}.w-45{width:45%}.w-50{width:50%}.w-55{width:55%}
  .w-60{width:60%}.w-65{width:65%}.w-70{width:70%}.w-75{width:75%}.w-80{width:80%}.w-85{width:85%}
  .w-90{width:90%}.w-95{width:95%}.w-100{width:100%}

  /* Chips (Range & AV) */
  .chip { display:inline-block; padding:6px 8px; border-radius:9999px; font-size:11px; line-height:1.2; border:1px solid transparent; }
  .chip-emerald { background:#ecfdf5; color:#047857; border-color:#a7f3d0; }
  .chip-amber   { background:#fffbeb; color:#b45309; border-color:#fde68a; }
  .chip-rose    { background:#fff1f2; color:#be123c; border-color:#fecdd3; }

  .chip-blue         { background:#eff6ff; color:#1d4ed8; border-color:#bfdbfe; }
  .chip-lightemerald { background:#f0fdf4; color:#059669; border-color:#bbf7d0; }

  .chip-av-coping         { background:#ecfdf5; color:#047857; border-color:#a7f3d0; }
  .chip-av-slightlycoping { background:#fffbeb; color:#b45309; border-color:#fde68a; }
  .chip-av-notcoping      { background:#fff1f2; color:#be123c; border-color:#fecdd3; }

  /* Tiny shared helper */
  .section-label { font-weight:700; margin-bottom:6px; font-size:12px; color:#0f172a; }
</style>

<style>
  /* ===== Graph scaffold (shared) ===== */
  .loss-graph-wrap{border:1px solid #cbd5e1;border-radius:10px;background:#fff;padding:12px;margin-top:8px}
  .loss-graph-scale{display:flex;justify-content:space-between;font-size:.75rem;color:#475569;margin-bottom:6px}
  .loss-graph-area{position:relative;height:220px;background:#f1f5f9;border-radius:8px;display:grid;grid-template-columns:repeat(4,1fr);gap:12px;padding:10px 10px 24px 10px}
  .loss-gridline{position:absolute;left:0;right:0;border-top:1px dashed #94a3b8}
  .loss-gl33{bottom:33%}.loss-gl66{bottom:66%}.loss-gl85{bottom:85%}
  .loss-gl-tag{position:absolute;right:6px;transform:translateY(-50%);font-size:.7rem;color:#475569;background:rgba(255,255,255,.75);padding:0 .25rem}

  /* ===== Solid segment bar (no inline height) ===== */
  .loss-bar{position:relative;background:#ffffff;border:1px solid #cbd5e1;border-radius:6px;display:flex;align-items:flex-end;justify-content:center}
  .loss-bar--seg{height:220px}
  .loss-bar-col{
    position:absolute;bottom:8px;left:50%;transform:translateX(-50%);
    height:88%;width:82%;display:flex;flex-direction:column-reverse
  }
  /* each segment: NO borders/gaps -> appears as a solid fill */
  .loss-seg{flex:1 0 auto;background:transparent}
  .loss-seg--filled{background:currentColor} /* color is inherited from .loss-bar--{palette} */
  .loss-bar-pct{position:absolute;bottom:4px;left:0;right:0;text-align:center;font-size:.75rem;font-weight:700;color:#0f172a}
  .loss-bar-label{position:absolute;bottom:-18px;left:0;right:0;text-align:center;font-size:.75rem;color:#475569}

  /* ===== Palettes ===== */
  .loss-bar--emerald{ color:#10b981 }   /* good */
  .loss-bar--amber{   color:#f59e0b }   /* medium */
  .loss-bar--rose{    color:#ef4444 }   /* high (1–3) */
  .loss-bar--blue{    color:#3b82f6 }   /* low (phase 4) */
  .loss-bar--mint{    color:#34d399 }   /* mid (phase 4) */
</style>

<style>
/* Kill the pale panel behind the old graphs */
.loss-graph-area, .loss-graph-wrap {
  background: transparent !important;
  border: none !important;
}

/* ===== Horizontal bars (per-phase + group) ===== */
.hbar-wrap{ margin-top:6px }
.hbar-scale{
  display:flex; justify-content:space-between;
  font-size:.75rem; color:#475569; margin-bottom:4px
}
.hbar{ width:100% }
.hbar-track{
  display:grid; grid-template-columns:repeat(100, 1fr);
  gap:0; height:16px; border:1px solid #cbd5e1; border-radius:8px; overflow:hidden;
}
.hseg{ background:transparent }
.hseg--filled{ background:currentColor }   /* uses the element's color */
.hseg--emerald{ color:#10b981 }  /* good */
.hseg--amber{   color:#f59e0b }  /* medium */
.hseg--rose{    color:#ef4444 }  /* high (phases 1–3) */
.hseg--blue{    color:#3b82f6 }  /* low (phase 4) */
.hseg--mint{    color:#34d399 }  /* mid (phase 4) */
.hbar-meta{
  display:flex; justify-content:space-between; align-items:center;
  margin-top:4px; font-size:.8rem; color:#334155
}
.hbar-label{ font-weight:600 }
.hbar-pct{ font-weight:700 }

/* Group under “Phase Graph” */
.hbar-group{ display:flex; flex-direction:column; gap:10px; margin-bottom:12px }
.png-graph{ margin-top:8px; text-align:center }
</style>

<style>
/* ===== Vertical 4-bar chart ===== */
.vbar-wrap { border:1px solid #cbd5e1; border-radius:12px; background:#fff; padding:12px; margin-top:8px }
.vbar-scale { display:flex; justify-content:space-between; font-size:.75rem; color:#475569; margin-bottom:6px }
.vbar-area {
  position:relative; height:260px; border-radius:10px;
  display:grid; grid-template-columns:repeat(4,1fr); gap:14px; padding:10px 10px 28px 10px;
  background:#fff;           /* clean (no blue panel) */
  border:1px solid #e2e8f0;  /* subtle frame */
}

/* gridlines */
.vgrid { position:absolute; left:8px; right:8px; border-top:1px dashed #94a3b8 }
.vgrid33 { bottom:33% } .vgrid66 { bottom:66% } .vgrid85 { bottom:85% }
.vgrid-tag {
  position:absolute; right:4px; transform:translateY(-50%);
  font-size:.7rem; color:#475569; background:rgba(255,255,255,.8); padding:0 .25rem
}

/* columns */
.vcol { position:relative; background:#ffffff; border:1px solid #cbd5e1; border-radius:8px }
.vstack {
  position:absolute; bottom:8px; left:50%; transform:translateX(-50%);
  height:84%; width:78%; display:flex; flex-direction:column-reverse; overflow:hidden; border-radius:6px
}
.vseg { flex:1 0 auto; background:transparent }
.vseg--filled { background:currentColor }  /* takes color from vcol--* */

.vcol-pct {
  position:absolute; bottom:6px; left:0; right:0; text-align:center;
  font-size:.78rem; font-weight:700; color:#0f172a
}
.vcol-label {
  position:absolute; bottom:-26px; left:0; right:0; text-align:center; font-size:.7rem; color:#475569
}
.vcol-phase { font-weight:700 }
.vcol-name { font-size:.68rem }

/* fixed palette by phase (matches classic screenshot: blue/green/orange/red) */
.vcol--p1 { color:#3b82f6 }  /* Phase 1 — blue   */
.vcol--p2 { color:#10b981 }  /* Phase 2 — green  */
.vcol--p3 { color:#f59e0b }  /* Phase 3 — orange */
.vcol--p4 { color:#ef4444 }  /* Phase 4 — red    */
</style>
