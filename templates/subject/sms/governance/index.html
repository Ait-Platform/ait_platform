{% extends "layout.html" %}
{% block title %}Governance · SMS{% endblock %}

{% block content %}
<div class="mx-auto max-w-5xl py-8">

  <!-- Header -->
  <div class="mb-6">
    <p class="text-sm text-slate-500">
      School Management System · Governance
    </p>
    <h1 class="mt-1 text-2xl font-semibold text-slate-900">
      SGB &amp; Governance
    </h1>
    <p class="mt-1 text-sm text-slate-600">
      Capture SGB members and meetings. More tools will unlock as we expand this module.
    </p>
    <p class="mt-1 text-xs text-slate-500">
      {{ school.short_code or "" }} · {{ school.name }}
    </p>
  </div>

  <!-- Two wide tiles in one row -->
  <div class="mt-6 mx-auto max-w-4xl grid grid-cols-1 md:grid-cols-2 gap-8">

    <!-- SGB members -->
    <div class="w-full rounded-xl border border-slate-200 bg-white p-5 shadow-sm">
      <div class="flex items-center justify-between mb-3">
        <h2 class="text-base font-semibold text-slate-900">SGB members</h2>

        <!-- Green: Add member -->
        <a
          href="{{ url_for('sms_bp.governance_member_new') }}"
          class="inline-flex items-center rounded-md px-3 py-1.5 text-xs font-medium
                 bg-emerald-600 text-white hover:bg-emerald-700 focus:outline-none
                 focus:ring-2 focus:ring-emerald-500 focus:ring-offset-1">
          + Add member
        </a>
      </div>

      {% if members %}
        <ul class="space-y-2 text-sm">
          {% for m in members %}
            <li class="flex items-center justify-between">
              <div>
                <div class="font-medium text-slate-800">{{ m.full_name }}</div>
                <div class="text-xs text-slate-500">
                  {{ m.role }}
                  {% if m.start_date %}
                    · since {{ m.start_date.strftime("%Y-%m-%d") }}
                  {% endif %}
                </div>
              </div>
              {% if not m.is_active %}
                <span class="text-[11px] rounded-full bg-slate-100 px-2 py-0.5 text-slate-600">
                  Inactive
                </span>
              {% endif %}
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p class="text-sm text-slate-500">
          No SGB members captured yet. Start by adding your Chairperson and Principal.
        </p>
      {% endif %}
    </div>

    <!-- Meetings -->
    <div class="w-full rounded-xl border border-slate-200 bg-white p-5 shadow-sm">
      <div class="flex items-center justify-between mb-3">
        <h2 class="text-base font-semibold text-slate-900">Meetings &amp; minutes</h2>

        <!-- Blue: Record meeting -->
        <a
          href="{{ url_for('sms_bp.governance_meeting_new') }}"
          class="inline-flex items-center rounded-md px-3 py-1.5 text-xs font-medium
                 bg-indigo-600 text-white hover:bg-indigo-700 focus:outline-none
                 focus:ring-2 focus:ring-indigo-500 focus:ring-offset-1">
          + Record meeting
        </a>
      </div>

      {% if meetings %}
        <ul class="space-y-2 text-sm">
          {% for mtg in meetings %}
            <li>
              <div class="flex items-center justify-between">
                <div>
                  <div class="font-medium text-slate-800">
                    {{ mtg.meeting_date.strftime("%Y-%m-%d") }}
                    {% if mtg.term %} · Term {{ mtg.term }}{% endif %}
                  </div>
                  {% if mtg.agenda %}
                    <div class="text-xs text-slate-500">
                      {{ mtg.agenda[:90] }}{% if mtg.agenda|length > 90 %}…{% endif %}
                    </div>
                  {% endif %}
                </div>
                {% if mtg.approved %}
                  <span class="text-[11px] rounded-full bg-emerald-50 px-2 py-0.5 text-emerald-700 border border-emerald-200">
                    Approved
                  </span>
                {% else %}
                  <span class="text-[11px] rounded-full bg-amber-50 px-2 py-0.5 text-amber-700 border border-amber-200">
                    Draft
                  </span>
                {% endif %}
              </div>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p class="text-sm text-slate-500">
          No meetings recorded yet. Capture your last formal SGB meeting to get started.
        </p>
      {% endif %}
    </div>

  </div>

  <!-- Footer links -->
  <div class="mt-8 flex items-center justify-between text-sm">
    <a href="{{ url_for('sms_bp.subject_home') }}"
       class="text-slate-600 hover:text-slate-900">
      ← Back to SMS home
    </a>

    <a href="{{ url_for('auth_bp.learner_subject_dashboard', subject='sms') }}"
       class="text-slate-600 hover:text-slate-900">
      ← Back to program dashboard
    </a>
  </div>

</div>
{% endblock %}
