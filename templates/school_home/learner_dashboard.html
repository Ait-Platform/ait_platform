{% extends "layout.html" %}
{% block title %}Progress Chart | AIT{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto py-8 px-4">

  <!-- Header -->
  <h1 class="text-2xl font-bold text-blue-800 mb-2">
    ğŸ“˜ Hands On Math Education â€” Progress Chart
  </h1>

  <p class="text-gray-700 mb-6">
    <strong>School:</strong> Mathematics<br>
    <strong>Curriculum:</strong> HOMEâ„¢
  </p>

  <!-- Section & Test Progress Table -->
  <table class="w-full table-auto border-collapse text-sm mb-6 shadow-md">
    <thead class="bg-gray-200 text-gray-700">
      <tr>
        <th class="border px-4 py-2 text-left">Section</th>
        <th class="border px-4 py-2 text-left">Progress</th>
        <th class="border px-4 py-2 text-left">Status</th>
      </tr>
    </thead>
    <tbody class="bg-white">
      {% set section_names = ["Foundation", "Shapes", "Measurement", "Patterns", "Problem Solving"] %}
      {% for i in range(5) %}
        {% set section_number = i + 1 %}
        {% set section_key = 'section_' ~ section_number ~ '_done' %}

        <!-- Section Row -->
        <tr class="hover:bg-gray-50">
          <td class="border px-4 py-2 font-medium">{{ section_names[i] }}</td>
          <td class="border px-4 py-2">
            {% if session.get(section_key) %}
              âœ… Completed
            {% else %}
              âŒ Not Started
            {% endif %}
          </td>
          <td class="border px-4 py-2">
            {% if not session.get(section_key) %}
              <!-- Button placeholder for marking complete -->
            {% else %}
              <span class="text-green-600">Ready for Test {{ section_number }}</span>
            {% endif %}
          </td>
        </tr>

        <!-- Test Row -->
        <tr class="hover:bg-gray-50">
          <td class="border px-4 py-2 text-blue-700">Test {{ section_number }}</td>
          <td class="border px-4 py-2">
            {% if session.get(section_key) %}
              <!-- Link placeholder for taking test -->
            {% else %}
              <span class="text-gray-400">0%</span>
            {% endif %}
          </td>
          <td class="border px-4 py-2 text-gray-500">
            {% if session.get(section_key) %}
              âœ… Unlocked
            {% else %}
              ğŸ”’ Locked
            {% endif %}
          </td>
        </tr>
      {% endfor %}

      <!-- Final Exam -->
      {% set all_sections_done = session.get('section_1_done') and session.get('section_2_done') and session.get('section_3_done') and session.get('section_4_done') and session.get('section_5_done') %}
      <tr class="bg-gray-50 hover:bg-gray-100">
        <td class="border px-4 py-2 font-semibold text-red-700">Final Exam</td>
        <td class="border px-4 py-2">
          {% if all_sections_done %}
            <!-- Link placeholder for final exam -->
          {% else %}
            <span class="text-gray-400">0%</span>
          {% endif %}
        </td>
        <td class="border px-4 py-2 text-gray-500">
          {% if all_sections_done %}
            âœ… Unlocked
          {% else %}
            ğŸ”’ Locked
          {% endif %}
        </td>
      </tr>
    </tbody>
  </table>

  <!-- Certification & Diagnostic Report -->
  <h2 class="text-xl font-semibold text-green-700 mb-2">ğŸ“ Certification & Diagnostic Report</h2>
  {% if report or session.get('diagnostic_report') %}
    {% set r = report or session.get('diagnostic_report') %}
    <p class="mb-2">ğŸ“Š Overall Score: <strong>{{ r.overall_score }}%</strong></p>
    <p class="mb-2">ğŸ“œ Remark: <em>{{ r.remark }}</em></p>
  {% else %}
    <p class="text-gray-600">Report will be available after the final exam has been completed and submitted.</p>
  {% endif %}

  {% if session.get('final_exam_score') %}
    <p class="mt-4 text-green-700">
      ğŸ“ <!-- Link placeholder for certificate -->
    </p>
  {% endif %}

</div>
{% endblock %}
