{% extends "layout.html" %}
{% block title %}Redirecting to PayFast… · AIT{% endblock %}

{% block content %}
<div class="mx-auto max-w-xl py-10">
  <h1 class="text-2xl font-semibold mb-4">Redirecting to PayFast…</h1>
  <p class="text-slate-600 mb-6">
    Please wait while we securely hand you off to PayFast to complete your payment.
  </p>

  {# accept either pf_data (new) or payfast_fields (old) #}
  {% set fields = pf_data if pf_data is defined else payfast_fields %}

  <form id="pf-form" action="{{ payfast_url }}" method="post">
    {% for name, value in fields.items() %}
      <input type="hidden" name="{{ name }}" value="{{ value }}">
    {% endfor %}

    <button
      type="submit"
      class="inline-flex items-center rounded-md border border-slate-300 px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50"
    >
      Continue to PayFast
    </button>
  </form>

  <script>
    // auto-submit after a short delay
    setTimeout(function () {
      document.getElementById('pf-form').submit();
    }, 800);
  </script>
</div>
{% endblock %}
